<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
      <title>Dear-God-Why on nathan leclaire </title>
      <generator uri="https://hugo.spf13.com">Hugo</generator>
    <link>http://localhost:1313/categories/dear-god-why/index.xml</link>
    
    
    
    <updated>Mon, 01 Jan 0001 00:00:00 UTC</updated>
    
    <item>
      <title>Fixing Cygwin&#39;s SSL issues with git clone / c_rehash bug</title>
      <link>http://localhost:1313/_posts/2014-03-23-cygwin-git-clone-ssl-issue-c_rehash-openssl-not-found</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 UTC</pubDate>
      
      <guid>http://localhost:1313/_posts/2014-03-23-cygwin-git-clone-ssl-issue-c_rehash-openssl-not-found</guid>
      <description>

&lt;h1 id=&#34;toc_0&#34;&gt;Cygwin&amp;rsquo;s git clone drama&lt;/h1&gt;

&lt;p&gt;{%img /images/cygwin-ssl/cygwin.png %}&lt;/p&gt;

&lt;h2 id=&#34;toc_1&#34;&gt;Oh, you.&lt;/h2&gt;

&lt;p&gt;When I am working on Windows for the various reasons which compel one to work on Windows I often use &lt;a href=&#34;http://www.cygwin.com&#34;&gt;Cygwin&lt;/a&gt; to provide UNIX-like functionality on the command line (cmd.exe leaves a lot to be desired).  Since a vital part of my workflow on any OS is &lt;a href=&#34;http://git-scm.com&#34;&gt;git&lt;/a&gt; I happily installed git using the Install.exe workflow that Cygwin provides.&lt;/p&gt;

&lt;p&gt;To my surprise (and, I&amp;rsquo;m not going to deny it, slight nerd-rage) when I attempted to &lt;code&gt;git clone&lt;/code&gt; a repository from Github I was greeted by an error message like this one:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ git clone https://github.com/foo/bar
error: SSL certificate problem, verify that the CA cert is OK. Details:
error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate verify failed
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;OK, so I have an SSL issue.  Running through the Setup.exe with Cygwin again and installing &lt;code&gt;ca-certificates&lt;/code&gt; and &lt;code&gt;openssl&lt;/code&gt; didn&amp;rsquo;t fix it, and eventually I came across &lt;a href=&#34;http://stackoverflow.com/questions/3777075/ssl-certificate-rejected-trying-to-access-github-over-https-behind-firewall&#34;&gt;this Stack Overflow post&lt;/a&gt; which described my exact issue.&lt;/p&gt;

&lt;h1 id=&#34;toc_2&#34;&gt;On the hunt for solutions&lt;/h1&gt;

&lt;h2 id=&#34;toc_3&#34;&gt;One proposed solution&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;$ git config --global http.sslVerify false
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;SERIOUSLY!?!?&lt;/p&gt;

&lt;p&gt;No way I&amp;rsquo;m going to turn off SSL just to try and workaround this issue.  I don&amp;rsquo;t like getting MITMed.&lt;/p&gt;

&lt;h2 id=&#34;toc_4&#34;&gt;A much better proposed solution&lt;/h2&gt;

&lt;p&gt;Also from Stack Overflow:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ cd /usr/ssl/certs
$  curl http://curl.haxx.se/ca/cacert.pem | awk &#39;split_after==1{n++;split_after=0} /-----END CERTIFICATE-----/ {split_after=1} {print &amp;gt; &amp;quot;cert&amp;quot; n &amp;quot;.pem&amp;quot;}&#39;
$ c_rehash
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;OK, this is headed in the right direction, I can tell.  I had to manually create the &lt;code&gt;/usr/ssl/certs&lt;/code&gt; directory (probably because I hadn&amp;rsquo;t installed OpenSSL yet when I tried this), but even after getting OpenSSL &lt;code&gt;c_rehash&lt;/code&gt; was giving me an error:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ c_rehash
c_rehash: rehashing skipped (&#39;openssl&#39; program not available)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Pretty odd, since just typing &lt;code&gt;openssl&lt;/code&gt; on the CLI clearly indicated that it was present.&lt;/p&gt;

&lt;h2 id=&#34;toc_5&#34;&gt;Debuggin&amp;rsquo; some Perl code&lt;/h2&gt;

&lt;p&gt;Nothing too fruitful was turning up on Google for this (the &lt;a href=&#34;http://koti.kapsi.fi/ptk/postfix/c_rehash.txt&#34;&gt;original program source&lt;/a&gt; was, though :P) so I dug into the program source (Perl) and found this bit at the top:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;my $openssl;

my $dir = &amp;quot;/usr/lib/ssl&amp;quot;;

if(defined $ENV{OPENSSL}) {
    $openssl = $ENV{OPENSSL};
} else {
    $openssl = &amp;quot;openssl&amp;quot;;
    $ENV{OPENSSL} = $openssl;
}

$ENV{PATH} .= &amp;quot;:$dir/bin&amp;quot;;

if(! -x $openssl) {
    my $found = 0;
    foreach (split /:/, $ENV{PATH}) {
        if(-x &amp;quot;$_/$openssl&amp;quot;) {
            $found = 1;
            last;
        }   
    }
    if($found == 0) {
        print STDERR &amp;quot;c_rehash: rehashing skipped (&#39;openssl&#39; program not available)\n&amp;quot;;
        exit 0;
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Sprinkling some liberal debugging statements into that yielded me the information that &lt;code&gt;c_rehash&lt;/code&gt; was finding the relevant directories (and consequently the &lt;code&gt;openssl&lt;/code&gt; binary) but the file wasn&amp;rsquo;t showing up as executable.  Some Googling turned up stuff like &lt;a href=&#34;http://cygwin.com/ml/cygwin/2007-05/msg00681.html&#34;&gt;this&lt;/a&gt;, which made me wonder&amp;hellip;&lt;/p&gt;

&lt;h2 id=&#34;toc_6&#34;&gt;If &lt;em&gt;this&lt;/em&gt; solution would work&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;$ which openssl
/cygdrive/c/Program Files (x86)/Git/bin/openssl
$ chmod +x /cygdrive/c/Program\ Files\ \(x86\)/Git/bin/openssl
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;It did!  You have to run Cygwin as administrator to have the proper permissions though to change those file permissions though.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;c_rehash&lt;/code&gt; then went through without a hitch, Which finally allowed &lt;code&gt;git clone&lt;/code&gt; to work.&lt;/p&gt;

&lt;h1 id=&#34;toc_7&#34;&gt;Conclusion&lt;/h1&gt;

&lt;p&gt;Whew!  That was exhausting.  Time to do some programming to unwind :)&lt;/p&gt;

&lt;p&gt;Until next time, stay sassy Internet.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Nathan&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
  </channel>
</rss>